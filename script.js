// 3行構成のマイクロフォント
const FONT = {
  // 英数字 (3行スタイル)
  A: ["▄▀▀▄", "█▄▄█", "█░░█"],
  B: ["█▀▀▄", "█▀▀▄", "▀▀▀░"],
  C: ["▄▀▀▀", "█░░░", "▀▀▀▀"],
  D: ["█▀▀▄", "█░░█", "▀▀▀░"],
  E: ["█▀▀▀", "█▀▀░", "▀▀▀▀"],
  F: ["█▀▀▀", "█▀▀░", "▀░░░"],
  G: ["▄▀▀▀", "█░▀█", "▀▀▀▀"],
  H: ["█░░█", "█▀▀█", "█░░█"],
  I: ["▀█▀", "░█░", "▀▀▀"],
  J: ["░░█", "░░█", "▀▀░"],
  K: ["█░▄▀", "█▀▄░", "█░░▀"],
  L: ["█░░░", "█░░░", "▀▀▀▀"],
  M: ["█▄░█", "█░▀█", "▀░░▀"],
  N: ["█▄░█", "█░▀█", "▀░░▀"],
  O: ["▄▀▀▄", "█░░█", "▀▄▄▀"],
  P: ["█▀▀▄", "█▀▀▄", "▀░░░"],
  Q: ["▄▀▀▄", "█░░█", "▀▀▄▀"],
  R: ["█▀▀▄", "█▀▀▄", "▀░░▀"],
  S: ["▄▀▀▀", "▀▀▀▄", "▀▀▀░"],
  T: ["▀█▀", "░█░", "░▀░"],
  U: ["█░░█", "█░░█", "▀▄▄▀"],
  V: ["█░░█", "█░░█", "░▀▀░"],
  W: ["█░░█", "█░▀█", "░▀░▀"],
  X: ["█░░█", "░▀▀░", "█░░█"],
  Y: ["█░░█", "░▀▀░", "░▀░░"],
  Z: ["▀▀▀█", "░▄▀░", "█▀▀▀"],
  "0": ["▄▀▀▄", "█░░█", "▀▄▄▀"],
  "1": ["▄█░", "░█░", "▄█▄"],
  "2": ["▀▀▀▄", "▄▀▀░", "████"],
  "3": ["▀▀▀▄", "░▀▀▄", "▀▀▀░"],
  "4": ["█░▄░", "████", "░░█░"],
  "5": ["████", "▀▀▀▄", "▀▀▀░"],
  "6": ["▄▀▀▀", "█▀▀▄", "▀▀▀░"],
  "7": ["████", "░░█░", "░░▀░"],
  "8": ["▄▀▀▄", "█▀▀█", "▀▄▄▀"],
  "9": ["▄▀▀█", "▀▀▀█", "▀▀▀░"],
  "!": ["█", "█", "▀"],
  "?": ["▀▀█", "░▄▀", "░▀░"],

  // カタカナ (3行スタイル)
  ア: ["▀█▀", "░█░", "░▀░"],
  イ: ["░█", "░█", "░▀"],
  ウ: ["▀▀█", "▄▄█", "▀▀▀"],
  エ: ["███", "░█░", "███"],
  オ: ["█▄█", "░█░", "░▀░"],
  カ: ["█░█", "▀▄▀", "░▀░"],
  キ: ["▀█▀", "▀█▀", "░▀░"],
  ク: ["▀▀█", "░▄▀", "░▀░"],
  ケ: ["█▄█", "░█░", "░▀░"],
  コ: ["▀▀█", "█░░", "▀▀▀"],
  サ: ["▀█▀", "░█░", "▄▀░"],
  シ: ["█░░", "█░░", "░▀▀"],
  ス: ["▀▀█", "░▄▀", "░█░"],
  セ: ["█▀█", "░█░", "░▀▀"],
  ソ: ["▀░█", "░▄▀", "░▀░"],
  タ: ["▀▀█", "░█░", "░▀░"],
  チ: ["▀█▀", "░█░", "░▀░"],
  ツ: ["█░█", "░▄▀", "░▀░"],
  テ: ["▀▀▀", "░█░", "░▀░"],
  ト: ["█░░", "█▀▀", "▀░░"],
  ナ: ["▀█▀", "░█░", "░▀░"],
  ニ: ["▀▀▀", "░░░", "▀▀▀"],
  ヌ: ["█▀▄", "░█░", "▀░▀"],
  ネ: ["█▀█", "░█░", "▀░▀"],
  ノ: ["░▄▀", "▄▀░", "▀░░"],
  ハ: ["█░█", "█▀█", "▀░▀"],
  ヒ: ["█░░", "█▀▀", "▀▀▀"],
  フ: ["▀▀█", "░░░", "░░░"],
  ヘ: ["▄▀▄", "▀░▀", "░░░"],
  ホ: ["█▄█", "░█░", "▀░▀"],
  マ: ["▀▀▀", "▀▀▀", "░▀░"],
  ミ: ["▀▀▀", "▀▀▀", "▀▀▀"],
  ム: ["█░░", "█▀▀", "▀▀▀"],
  メ: ["█░█", "░▀▄", "░░▀"],
  モ: ["▀█▀", "▀█▀", "░▀░"],
  ヤ: ["█▀█", "░█░", "░▀░"],
  ユ: ["█▀█", "█░█", "▀▀▀"],
  ヨ: ["▀▀█", "▀▀█", "▀▀▀"],
  ラ: ["▀▀▀", "░▄▀", "░▀░"],
  リ: ["█░█", "█░█", "▀░▀"],
  ル: ["█░█", "█▀█", "▀░▀"],
  レ: ["█░░", "█░░", "░▀▀"],
  ロ: ["█▀█", "█░█", "▀▀▀"],
  ワ: ["▀▀█", "█░█", "▀▀▀"],
  ン: ["█░░", "█▄█", "░▀▀"],
  "ー": ["░░░", "▀▀▀", "░░░"],
  " ": ["░░", "░░", "░░"]
};

// 変換マップ
const NORMALIZE_MAP = {
  'が':'か','ぎ':'き','ぐ':'く','げ':'け','ご':'こ','ざ':'さ','じ':'し','ず':'す','ぜ':'せ','ぞ':'そ',
  'だ':'た','ぢ':'ち','づ':'つ','で':'て','ど':'と','ば':'は','び':'ひ','ぶ':'ふ','べ':'へ','ぼ':'ほ',
  'ぱ':'は','ぴ':'ひ','ぷ':'ふ','ぺ':'へ','ぽ':'ほ','ぁ':'あ','ぃ':'い','ぅ':'う','ぇ':'え','ぉ':'お',
  'っ':'つ','ゃ':'や','ゅ':'ゆ','ょ':'よ','あ':'ア','い':'イ','う':'ウ','え':'エ','お':'オ',
  'か':'カ','き':'キ','く':'ク','け':'ケ','こ':'コ','さ':'サ','し':'シ','す':'ス','せ':'セ','そ':'ソ',
  'た':'タ','ち':'チ','つ':'ツ','て':'テ','と':'ト','な':'ナ','に':'ニ','ぬ':'ヌ','ね':'ネ','の':'ノ',
  'は':'ハ','ひ':'ヒ','ふ':'フ','へ':'ヘ','ほ':'ホ','ま':'マ','み':'ミ','む':'ム','め':'メ','も':'モ',
  'や':'ヤ','ゆ':'ユ','よ':'ヨ','ら':'ラ','り':'リ','る':'ル','れ':'レ','ろ':'ロ','わ':'ワ','を':'ヲ','ん':'ン'
};

const HEIGHT = 3;

document.getElementById("gen").addEventListener("click", () => {
  let input = document.getElementById("text").value;
  input = input.normalize("NFKC").toUpperCase();

  let normalizedInput = "";
  for (let char of input) {
    normalizedInput += NORMALIZE_MAP[char] || char;
  }

  let lines = Array(HEIGHT).fill("");
  
  // VALORANTのチャットで中央に見えるようにするための左余白（適宜調整）
  const padding = "░░"; 

  for (const c of normalizedInput) {
    const g = FONT[c];
    if (!g) continue;
    for (let i = 0; i < HEIGHT; i++) {
      lines[i] += g[i] + "░";
    }
  }

  // 最後に上下の余白（░）を足すとより安定します
  const topBottom = "░".repeat(lines[0].length);
  const result = [topBottom, ...lines, topBottom].join("\n");

  document.getElementById("output").value = result;
});

// コピー機能
document.getElementById("copy").addEventListener("click", () => {
  const output = document.getElementById("output");
  output.select();
  navigator.clipboard.writeText(output.value).then(() => {
    const btn = document.getElementById("copy");
    btn.innerText = "Copied!";
    setTimeout(() => btn.innerText = "コピー", 2000);
  });
});